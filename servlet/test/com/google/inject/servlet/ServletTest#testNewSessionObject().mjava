  public void testNewSessionObject() throws Exception {
    expect(request.getSession()).andReturn(session);
    expect(session.getAttribute(sessionKey.toString())).andReturn(null);
    session.setAttribute(eq(sessionKey.toString()), isA(InSession.class));

    filterChain = new FilterChain() {
      public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse) {
        invoked = true;
        assertSame(request, servletRequest);
        assertNotNull(injector.getInstance(InSession.class));
      }
    };

    replayFilterAndVerify();
  }


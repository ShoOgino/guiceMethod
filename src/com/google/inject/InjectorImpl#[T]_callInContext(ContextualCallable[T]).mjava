  /** Looks up thread local context. Creates (and removes) a new context if necessary. */
  <T> T callInContext(ContextualCallable<T> callable) throws ErrorsException {
    InternalContext reference = localContext.get();
    reference.acquire();
    try {
      return callable.call(reference);
    } finally {
      reference.release();
    }
  }


  @Override
  public String getMessage() {
    StringBuilder result = new StringBuilder();
    result.append(errorMessage);

    for (int i = contexts.size() - 1; i >= 0; i--) {
      ExternalContext externalContext = contexts.get(i);
      result.append(String.format("%n"));
      result.append(contextToSnippet(externalContext));
    }

    return result.toString();
  }


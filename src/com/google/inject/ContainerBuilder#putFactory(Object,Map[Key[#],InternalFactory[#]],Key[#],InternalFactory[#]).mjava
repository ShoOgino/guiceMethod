  void putFactory(Object source, Map<Key<?>, InternalFactory<?>> factories,
      Key<?> key, InternalFactory<?> factory) {
    if (factories.containsKey(key)) {
      addError(source, ErrorMessage.BINDING_ALREADY_SET, key);
    } else {
      factories.put(key, factory);
    }
  }


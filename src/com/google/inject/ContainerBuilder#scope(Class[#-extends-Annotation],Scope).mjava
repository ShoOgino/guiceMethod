  /**
   * Adds a new scope. Maps a {@link Scope} instance to a given annotation.
   */
  public void scope(Class<? extends Annotation> annotationType, Scope scope) {
    ensureNotCreated();
    Scope existing = scopes.get(nonNull(annotationType, "annotation type"));
    if (existing != null) {
      addError(source(), ErrorMessages.DUPLICATE_SCOPES, existing,
          annotationType, scope);
    }
    else {
      scopes.put(annotationType, nonNull(scope, "scope"));
    }
  }


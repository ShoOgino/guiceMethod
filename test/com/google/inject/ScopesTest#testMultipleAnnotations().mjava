  public void testMultipleAnnotations() {
    final String[] messageHolder = new String[1];
    Scopes.getScopeNameForType(MultiplyAnnotated.class,
        new AbstractErrorHandler() {
          public void handle(String message) {
            messageHolder[0] = message;
          }

          public void handle(Throwable t) {
            fail();
          }
        });
    String message = messageHolder[0];
    assertTrue(message.startsWith("Scope is set more than once by annotations"
        + " on com.google.inject.ScopesTest$MultiplyAnnotated."));

    // We don't know what order these will come in, so we do our best.
    assertTrue(message.contains("@CustomScoped"));
    assertTrue(message.contains("custom"));
    assertTrue(message.contains("@Scoped"));
    assertTrue(message.contains("foo"));
  }


  <T> ContextualFactory<T> createFactory(
      final Class<T> type, final String name, final Member expectedMember) {
    return new ContextualFactory<T>() {
      public T get(Context context) {
        assertEquals(expectedMember, context.getMember());
        assertEquals(name, context.getKey().getName());
        assertEquals(type, context.getKey().getType().getType());
        return context.getContainer().getCreator(type).get();
      }
    };
  }


  public void testIntegration() throws ContainerCreationException {
    CountingInterceptor counter = new CountingInterceptor();
    ProxyFactoryBuilder proxyFactoryBuilder = new ProxyFactoryBuilder();
    proxyFactoryBuilder.intercept(all(), all(), counter);
    ProxyFactory proxyFactory = proxyFactoryBuilder.create();

    ContainerBuilder containerBuilder = new ContainerBuilder(proxyFactory);
    containerBuilder.bind(Foo.class);
    Container container = containerBuilder.create(false);

    Foo foo = container.getFactory(Key.get(Foo.class)).get();
    foo.foo();
    assertTrue(foo.invoked);
    assertEquals(1, counter.count);

    foo = container.getCreator(Foo.class).get();
    foo.foo();
    assertTrue(foo.invoked);
    assertEquals(2, counter.count);
  }


  public static Test suite() {
    SecurityManager securityManager = new SecurityManager() {
      @Override public void checkPermission(Permission permission) {
        if (permission instanceof FilePermission) {
          return;
        }

        if (permission instanceof RuntimePermission
            && permission.getName().equals("getClassLoader")
            && Arrays.toString(new Throwable().getStackTrace()).contains(".getSystemClassLoader(")) {
          throw new SecurityException("StrictContainerTestSuite forbids this!");
        }
      }

      @Override public void checkPermission(Permission permission, Object context) {
        checkPermission(permission);
      }
    };

    StrictContainerTestSuiteBuilder builder = new StrictContainerTestSuiteBuilder(securityManager);
    /*if[AOP]*/
    builder.add(BytecodeGenTest.class.getName());
    /*end[AOP]*/
    builder.addSuite(MapMakerTestSuite.class.getName());
    return builder.build();
  }


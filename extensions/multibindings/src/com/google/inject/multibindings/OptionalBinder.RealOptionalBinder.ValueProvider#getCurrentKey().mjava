      private Key<T> getCurrentKey() {
        // Every time, check if the key needs rehashing.
        // If so, update the field as an optimization for next time.
        Key<T> currentKey = key;
        if (needsRehashing(currentKey)) {
          currentKey = rehash(currentKey);
          key = currentKey;
        }
        return currentKey;
      }


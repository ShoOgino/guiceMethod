  public void testFailingScanner_scannerInModule() {
    Module module = new AbstractModule() {
      @Override public void configure() {
        install(new FailingScanner().forModule(new SomeModule()));
      }
    };
    try {
      Guice.createInjector(module);
      fail();
    } catch (CreationException expected) {
      Message m = Iterables.getOnlyElement(expected.getErrorMessages());
      assertEquals(
          "An exception was caught and reported. Message: Failing in the scanner.",
          m.getMessage());
      assertEquals(IllegalStateException.class, m.getCause().getClass());
      ElementSource source = (ElementSource) Iterables.getOnlyElement(m.getSources());
      assertEquals(ImmutableList.of(SomeModule.class.getName(), module.getClass().getName()),
          source.getModuleClassNames());
      assertEquals(String.class.getName() + " " + SomeModule.class.getName() + ".aString()",
          source.toString());
    }
  }


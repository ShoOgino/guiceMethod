  @Test
  public void provisionExceptionWithCustomErrorMessageIsSerializable() {
    Throwable cause = null;
    ProvisionException exception =
        new ProvisionException(
            ImmutableList.of(
                new Message(
                    ErrorId.OTHER,
                    new ExampleErrorDetail("Custom error", ImmutableList.of(), cause)),
                new Message("Generic error", cause)));
    assertThat(reserialize(exception))
        .hasMessageThat()
        .isEqualTo(
            "Unable to provision, see the following errors:\n\n"
                + "1) Custom error\n\n"
                + "2) Generic error\n\n"
                + "2 errors");
  }

